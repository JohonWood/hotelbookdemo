<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    <title>网站主页</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" type="text/css" media="all" href="../adminlte/bower_components/bootstrap/dist/css/bootstrap.min.css"
          th:href="@{/adminlte/bower_components/bootstrap/dist/css/bootstrap.min.css}"/>
    <link rel="stylesheet" type="text/css" media="all" href="../adminlte/bower_components/font-awesome/css/font-awesome.min.css"
          th:href="@{/adminlte/bower_components/font-awesome/css/font-awesome.min.css}"/>
    <link rel="stylesheet" type="text/css" media="all" href="../adminlte/bower_components/Ionicons/css/ionicons.min.css"
          th:href="@{/adminlte/bower_components/Ionicons/css/ionicons.min.css}"/>
    <link rel="stylesheet" type="text/css" media="all" href="../adminlte/dist/css/AdminLTE.min.css"
          th:href="@{/adminlte/dist/css/AdminLTE.min.css}"/>
    <link rel="stylesheet" type="text/css" media="all" href="../adminlte/dist/css/skins/skin-blue.min.css"
          th:href="@{/adminlte/dist/css/skins/skin-blue.min.css}"/>
    <link rel="stylesheet" type="text/css" media="all" href="../adminlte/bower_components/select2/dist/css/select2.min.css"
          th:href="@{/adminlte/bower_components/select2/dist/css/select2.min.css}">
    <link rel="stylesheet" type="text/css" media="all" href="../adminlte/dist/css/AdminLTE.min.css"
          th:href="@{/adminlte/dist/css/AdminLTE.min.css}">
    <link rel="stylesheet" href="../adminlte/bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="../adminlte/dist/css/skins/_all-skins.min.css">
    <style>
        a:hover {
            text-decoration: underline
        }
        #topArrow{
            width: 60px;
            height: 30px;
            border-radius: 10px;
            position: fixed;
            right: 15px;
            bottom: 20%;
            border: none;
        }

        #FilterDiv {
            width: 250px;
            height: 200px;
            border-radius: 10px;
            position: fixed;
            left: 15px;
            top: 23%;
            border: none;
            margin-left: -10px;
            z-index:999
        }
        #allmap{height:500px;width:1140px;position: absolute;
        }

    </style>
</head>
<body class="hold-transition skin-blue sidebar-mini layout-top-nav" onpagehide="myFunction()" onpageshow="myFunction1()">

<div class="wrapper">

    <header class="main-header">
        <nav class="navbar navbar-static-top bg-purple" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a href="/504/host" class="navbar-brand"><b>504</b>订购网</a>
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                        <i class="fa fa-bars"></i>
                    </button>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li class="dropdown"><a href="#">Link <span class="sr-only">(current)</span></a></li>
                        <li><a href="#">Link</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Action</a></li>
                                <li><a href="#">Another action</a></li>
                                <li><a href="#">Something else here</a></li>
                                <li class="divider"></li>
                                <li><a href="#">Separated link</a></li>
                                <li class="divider"></li>
                                <li><a href="#">One more separated link</a></li>
                            </ul>
                        </li>
                    </ul>
                    <div class="navbar-form navbar-left" role="search">
                        <div class="input-group">
                            <input id="searchText" type="text" name="hotelKey" class="form-control" placeholder="Search...">
                            <span class="input-group-btn">
                                <button type="button" name="search" id="search-btn" class="btn btn-adn bg-purple-active"><i class="fa fa-search"></i>
                                </button>
                                <button type="button" name="search" id="Area-btn" class="btn btn-adn bg-purple-active dropdown-toggle" data-toggle="dropdown"><i class="fa fa-map-pin"></i>
                                </button>
                                <ul class="dropdown-menu navbar-static-top" role="menu">
                                <li>
                                    <select name="countryKey" class="select2 CountrySelect" id="CountrySelect" style="width: 100%">
                                    <option th:each="country: ${countryList}" th:text="${country}" th:if="${country}!='中国'"></option>
                                    <option th:each="country: ${countryList}" th:text="${country}" selected="selected" th:if="${country}=='中国'"></option>
                                    </select>
                                </li>
                                <li>
                                    <select name="cityKey" class="form-control input-lg select2" id="CitySelect" style="width: 100%">
                                    <!--由JS代码生成-->
                                    </select>

                                </li>
                            </ul>
                            </span>
                        </div>
                        <!--<div class="form-group">-->
                            <!--<input type="text" class="form-control" id="navbar-search-input" placeholder="Search">-->
                        <!--</div>-->
                    </div>
                </div>
                <!-- /.navbar-collapse -->
                <!-- Navbar Right Menu -->
                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">
                        <!-- Tasks Menu -->
                        <li class="dropdown tasks-menu" th:if="${isLogin}==true">
                            <!-- Menu Toggle Button -->
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-flag-o"></i>
                                <span class="label label-danger" th:text="${numOfOrders}"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="header">你有<span th:text="${numOfOrders}"></span>个酒店订单</li>
                                <li>
                                    <!-- Inner menu: contains the tasks -->
                                    <ul class="menu">
                                        <li th:if="${numOfOrders}==0">
                                            <a href="#">
                                                <!-- Task title and progress text -->
                                                <h3>
                                                    无订单
                                                </h3>

                                                </p>
                                            </a>
                                        </li>
                                        <li th:each="order,orderStat: ${orderList}" th:if="${orderStat.count lt 3 && numOfOrders!=0}">
                                            <!-- Task item -->
                                            <a href="#">
                                                <!-- Task title and progress text -->
                                                <h3>
                                                    <span th:text="${order.hotelName}">酒店</span>
                                                </h3>
                                                <p class="text-black">
                                                    <span><span th:text="${order.roomNum}"></span>间房间</span>
                                                    <span class="pull-right"><i class="fa fa-calendar"></i>
                                            <span class="text-black" th:text='${order.checkInTime}'></span>入住</span>
                                                </p>
                                            </a>
                                        </li>
                                        <!-- end task item -->
                                    </ul>
                                </li>
                                <li class="footer">
                                    <a href="/mybook/booklist">查看所有订单</a>
                                </li>
                            </ul>
                        </li>
                        <!-- User Account Menu -->
                        <li class="dropdown user user-menu">
                            <!-- Menu Toggle Button -->
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <span class="hidden-xs" th:if="${isLogin}==true" th:text="${User_name}"></span>
                                <span class="hidden-xs" th:if="${isLogin}==false">未登录</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="user-header bg-purple">

                                    <p th:if="${isLogin}==true">
                                        <span th:text="${User_name}"></span>
                                        <br>
                                        <br>
                                        <small>亲爱的用户，欢迎来到504订房网！</small>
                                    </p>
                                    <p th:if="${isLogin}==false">
                                        <span>用户未登录</span>
                                        <br>
                                        <br>
                                        <small>如果未注册，请注册后登录网站</small>
                                    </p>
                                </li>
                                <!-- Menu Body -->
                                <li class="user-body" th:if="${isLogin}==true">
                                    <div class="row" style="">
                                        <div class="col-xs-4 text-center">

                                        </div>
                                        <div class="col-xs-4 text-center">
                                            <a href="/mybook/booklist">我的订单</a>
                                        </div>
                                        <div class="col-xs-4 text-center">
                                            <!--<a href="#">Friends</a>-->
                                        </div>
                                    </div>
                                    <!-- /.row -->
                                </li>
                                <!-- Menu Footer-->
                                <li class="user-footer" th:if="${isLogin}==true">
                                    <div class="pull-left">
                                        <a href="/user/userinfo" class="btn btn-default btn-flat">个人信息</a>
                                    </div>
                                    <div class="pull-right">
                                        <a href="/user/logoutAction" class="btn btn-default btn-flat">登出</a>
                                    </div>
                                </li>
                                <li class="user-footer" th:if="${isLogin}==false">
                                    <div class="pull-left">
                                        <a href="/user/login" class="btn btn-default btn-flat">登录</a>
                                    </div>
                                    <div class="pull-right">
                                        <a href="/user/register" class="btn btn-default btn-flat">注册</a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <!-- /.navbar-custom-menu -->
            </div>
            <!-- /.container-fluid -->
        </nav>
    </header>

    <div class="content-wrapper -align-center" th:style="'align-content: center;background: url('+@{/picture/backImg.jpg} + ') no-repeat center center fixed;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;'">

        <div class="top " id="FilterDiv" style="z-index:999;left: -200px" >
            <div class="box box-widget">
                <div class="box-header bg-purple">
                    <div class="user-block">
                        <span>筛选条件</span>
                    </div>
                    <!-- /.user-block -->
                    <div class="box-tools">
                        <button  type="button" class="btn btn-box-tool" id="filterBtn" style="transform:rotate(180deg);" ><i  class="fa fa-chevron-left fa-inverse"></i>
                        </button>
                    </div>
                    <!-- /.box-tools -->
                </div>
                <!-- /.box-header -->
                <div id="filterContent" style="display: none">
                    <div class="box-footer box-comments">
                        <div class="box-comment">
                            <div class="row" style="margin-left:10px">
                                <label>价格：</label>
                            </div>
                            <div class="input-group pull-left" style="width: 80px;">
                                <input id="lowText" type="text" name="lowPrice" class="form-control" placeholder="最低价">
                            </div>

                            <i class="fa fa-arrows-h fa-2x" aria-hidden="true" style="margin:3px 21px"></i>

                            <div class="input-group pull-right" style="width: 80px;">
                                <input id="highText" type="text" name="highPrice" class="form-control" placeholder="最高价">
                            </div>
                        </div>
                        <!-- /.box-comment -->
                        <div class="box-comment">
                            <div class="row" style="margin-left:10px">
                                <label>星级：</label>
                            </div>
                            <div class="input-group pull-left" style="width: 80px;">
                                <select id="gradeSelectL" class="select2" style="width: 80px;">
                                    <option id="gsl1" selected="selected">一星级</option>
                                    <option id="gsl2" >二星级</option>
                                    <option id="gsl3" >三星级</option>
                                    <option id="gsl4" >四星级</option>
                                    <option id="gsl5" >五星级</option>
                                </select>
                            </div>

                            <i class="fa fa-arrows-h fa-2x" aria-hidden="true" style="margin:3px 21px"></i>

                            <div class="input-group pull-right" style="width: 80px;">
                                <select id="gradeSelectH" class="select2" style="width: 80px;">
                                    <option id="gsh1" >一星级</option>
                                    <option id="gsh2" >二星级</option>
                                    <option id="gsh3" >三星级</option>
                                    <option id="gsh4" >四星级</option>
                                    <option id="gsh5" selected="selected">五星级</option>
                                </select>
                            </div>
                        </div>

                        <div class="box-comment">
                            <label style="margin-left:10px;margin-top: 5px">评分：</label>
                            <div class="input-group pull-right" style="width: 120px; margin-right: 40px">
                                <select id="ratingSelect" class="select2" style="width: 120px;">
                                    <option id="rs0" selected="selected">无要求</option>
                                    <option id="rs1" >1分以上</option>
                                    <option id="rs2" >2分以上</option>
                                    <option id="rs3" >3分以上</option>
                                    <option id="rs4" >4分以上</option>
                                    <option id="rs5" >5分以上</option>
                                    <option id="rs6" >6分以上</option>
                                    <option id="rs7" >7分以上</option>
                                    <option id="rs8" >8分以上</option>
                                    <option id="rs9" >9分以上</option>
                                </select>
                            </div>
                        </div>
                    </div>


                    <div class="box-footer">
                        <button type="button" name="filterSubmit"  id="filterSub" class="btn btn-adn bg-purple-active pull-right" style="width: 80px"><i class="fa fa-search"></i>
                        </button>
                    </div>
                </div>
                <!-- /.box-footer -->
            </div>
        </div>
        <div class="container">
            <!-- Content Header (Page header) -->
            <section  class="content-header">
                <h1>
                    搜索结果
                    <small>总计<span id="numOfHotel" th:text="${resultNum}"></span>家酒店</small>
                </h1>
                <ol class="breadcrumb">
                    <li><a href="/504/host"><i class="fa fa-dashboard"></i> 主页</a></li>
                    <li><a href="#">搜索结果</a></li>
                </ol>
            </section>
            <nav class="navbar navbar-static-top bg-purple" role="navigation" style="margin-top:20px;margin-bottom:0px;width:100%;z-index: 3;">
                <div class="container">

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left"  >
                        <ul class="nav navbar-nav">
                            <li class="dropdown"><a class="whiteToB" href="#" style="color:white">评分</a></li>
                            <li class="dropdown"><a class="whiteToB" href="#" style="color:white">星级</a></li>
                            <li class="dropdown">
                                <a href="#" class="whiteToB" id="orderPrice" style="color:white">价格<i id="orderArrow" class="fa fa-angle-down" ></i></a>
                            </li>
                        </ul>
                        <form class="navbar-form navbar-left" role="search"  method="post" style="right:50px;position:absolute; ">
                            <div class="input-group pull-right">

                                <span class="input-group-btn">
                                    <button type="button" id="listSwitch"  class="btn btn-adn bg-purple-active" title="列表显示"><i class="fa fa-list"></i></button>
                                    <button type="button" id="mapSwitch" class="btn btn-adn bg-purple-active" title="地图显示"><i class="fa fa-map"></i></button>
                                </span>
                            </div>
                        </form>

                        <!--<form class="navbar-form navbar-left" role="search"  method="post" style="right:50px;position:absolute; ">-->
                            <!--<button type="button"   class="btn btn-adn bg-purple-active">距离我</button>-->
                            <!--<div class="input-group pull-right">-->
                                <!--<input type="text" id="locInput" class="form-control" style="width: 60px">-->
                                <!--<span class="input-group-btn">-->
                                    <!--<select type="button" id="locSelect" class="btn btn-adn bg-purple-active" style="margin-left: 2px">-->
                                        <!--<option>公里</option>-->
                                        <!--<option>米</option>-->
                                    <!--</select>-->
                                    <!--<button type="button" id="locBtn"  class="btn btn-adn bg-purple-active"><i class="fa fa-search"></i></button>-->
                                <!--</span>-->
                            <!--</div>-->
                        <!--</form>-->
                    </div>

                </div>
            </nav>

            <div id="mapBox"  class="box pull-left" style="display: none;width:437px;height: 10px ;z-index:2 ;margin-bottom: 0px">
                <div id="mapListNav" class="box box-widget widget-user-2" style="width: 437px;">
                    <!-- Add the bg color to the header using any of the bg-* classes -->
                    <div  class="widget-user-header bg-purple" style="height: 50px;padding: 0px;">
                        <div class="navbar-form navbar-left" role="search" style="margin-left: 10px">
                            <div class="input-group">
                                <input type="text" id="mapHKey" class="form-control" placeholder="Search...">
                                <span class="input-group-btn">
                                <button id="mapNavBtn" type="button" class="btn btn-adn bg-purple-active"><i class="fa fa-search"></i>
                                </button>
                                <button type="button" name="search" class="btn btn-adn bg-purple-active dropdown-toggle" data-toggle="dropdown"><i class="fa fa-map-pin"></i>
                                </button>
                                <ul class="dropdown-menu navbar-static-top" role="menu">
                                <li>
                                    <select class="select2 CountrySelect" id="CountrySelect2" style="width: 100%">
                                    <option th:each="country: ${countryList}" th:text="${country}" th:if="${country}!='中国'"></option>
                                    <option th:each="country: ${countryList}" th:text="${country}" selected="selected" th:if="${country}=='中国'"></option>
                                    </select>
                                </li>
                                <li>
                                    <select class="form-control input-lg select2" id="CitySelect2" style="width: 100%">
                                    <!--由JS代码生成-->
                                    </select>

                                </li>
                            </ul>
                            </span>
                            </div>
                            <!--<div class="form-group">-->
                            <!--<input type="text" class="form-control" id="navbar-search-input" placeholder="Search">-->
                            <!--</div>-->
                        </div>
                        <button class="navbar-right navbar-btn btn btn-box-tool" style="margin-right: 30px" id="mapLisrBtn"><i class="fa fa-2x fa-caret-down fa-inverse"></i> </button>
                    </div>
                    <div id="tableWrapper" class="box-footer no-padding scrollBox" style="position:absolute; width:437px; height:440px; overflow-y:scroll;overflow-x: hidden;position: absolute">
                        <table id="example2" class="table table-bordered table-hover">
                            <thead style="display: none">
                            <tr>
                                <th></th>
                            </tr>
                            </thead>
                            <tbody id="tbody">
                            <tr ><td><div class="mapListDiv">
                                <a class="liBtn"  ><span>成都按时打算的撒酒店</span><span class="pull-right badge bg-blue" >7.1</span></a>
                                <p style="display: none;"class="mapStar">
                                    <span class="label label-warning">品质保证</span>
                                    <span >
                                        <i class="fa fa-fw fa-star"></i><i class="fa fa-fw fa-star"></i><i class="fa fa-fw fa-star"></i><i class="fa fa-fw fa-star"></i>
                                    </span>
                                </p>
                                <small class="mapStar" style="display: none;"><span >某某路某某街道12号</span> </small>
                            </div>
                            </td>
                            </tr>

                            </tbody>
                            <!--<tbody th:each="fResult,fResultStat: ${fullResult}" th:if="${resultNum!=0}">-->
                                <!--<tr ><td><div class="mapListDiv"><a class="liBtn"  ><span class="badge badge-pill" th:text="${fResultStat.count}"></span> <span th:text="${fResult.hotelName}"></span><span class="pull-right badge bg-blue" >31</span></a></div></td></tr>-->

                            <!--</tbody>-->
                        </table>

                    </div>
                </div>
            </div>

            <div id="allmap" class="pull-right" style="display: none;margin-top: 5px;margin-bottom: 20px;margin-top:3px"></div>
            <!-- Main content -->
            <section id="resultSection"  class="content">
                <div class="text-center" id="none1"  th:if="${resultNum==0}"><h3>无搜索结果</h3></div>
                <div class="text-center" id="none2" style="display: none"><h3>无搜索结果</h3></div>
                <div th:id="'resultList'+${resultStat.count}" class="box box-default fullResultBox" style="margin: 5px auto;" th:each="result,resultStat: ${resultList}" th:if="${resultNum!=0}">
                    <span th:id="'hotelID'+${resultStat.count}" style="visibility: hidden"; th:text="${result.hotelId}"></span>
                    <div class="box-body" style="padding-left: 10px;position: relative;">
                        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">
                            <img th:src="${result.hotelPhoto1}" alt="Product Image">
                        </div>
                        <div class="product-info" style="margin-right: 10px;overflow: hidden">
                            <h3 ><i class="fa fa-fw fa-bed pull-left"></i>
                                <a href="javascript:void(0)" class="product-title">
                                    <span th:text="${result.hotelName}"></span>
                                </a>
                                <span class="pull-right" >
                                    <a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">
                                         <i class="fa fa-thumbs-up"></i><span th:text="${result.hotelRating}"></span>
                                    </a>
                                </span>
                            </h3>
                            <h3>
                                <span class="pull-right text-red">
                                    <i class="fa fa-fw fa-cny"></i>
                                    <span class="hotelFee" th:text="${result.leastPrice}">
                                    </span>起
                                </span>
                            </h3>
                            <span>
                                <p id="hotelStar">
                                    <span class="label label-warning">品质保证</span>
                                    <span th:id="'hotelGradeStar'+${resultStat.count}" th:each="i:${#numbers.sequence(1,result.getHotelGrade())}">
                                        <i class="fa fa-fw fa-star"></i>
                                    </span>
                                </p>
                                <small><span th:text="${result.hotelAddress}"></span> </small>
                            </span>
                            <span class="product-description block">
                                <p><br>&emsp<span th:text="${result.getHotelOverview()}"></span></p>
                            </span>
                            <a class="btn bg-purple btn-lg pull-right infBtn" th:href="'/mybook/book?hotelID='+${result.hotelId}" th:id="'resultBtn'+${resultStat.count}">查看详情</a>
                        </div>
                    </div>
                </div>
                <div class="text-center btn bg-purple center-block downList" title="加载10项" id="downList" >
                    <span ><i class="fa fa-fw fa-chevron-down"></i></span>
                </div>
            </section>
        </div>

    </div>

    <div class="top text-center btn bg-purple" id="topArrow" title="回到顶部">
        <span  ><i id="TopArraow" class="fa fa-fw fa-chevron-up"></i></span>
    </div>
        <footer class="main-footer fixed">
        <!-- To the right -->
        <div class="pull-right hidden-xs">
            电子科技大学第20组
        </div>
        <!-- Default to the left -->
        <strong>Copyright &copy; 2019 <a href="https://www.uestc.edu.cn/">电子科技大学</a>.</strong> All rights reserved.
    </footer>
</div>




<script type="text/javascript" th:src="@{/adminlte/bower_components/jquery/dist/jquery.min.js}"
        src="../adminlte/bower_components/jquery/dist/jquery.min.js"></script>
<script type="text/javascript" th:src="@{/adminlte/bower_components/bootstrap/dist/js/bootstrap.min.js}"
        src="../adminlte/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script type="text/javascript" th:src="@{/adminlte/dist/js/adminlte.min.js}"
        src="../adminlte/dist/js/adminlte.min.js"></script>
<script src="../adminlte/bower_components/select2/dist/js/select2.full.min.js" type="text/javascript"
        th:src="@{/adminlte/bower_components/select2/dist/js/select2.full.min.js}"></script>
<!-- DataTables -->
<script src="../adminlte/bower_components/datatables.net/js/jquery.dataTables.min.js" type="text/javascript"
        th:src="@{/adminlte/bower_components/datatables.net/js/jquery.dataTables.min.js}"></script>
<script src="../adminlte/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js" type="text/javascript"
        th:src="@{/adminlte/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js}"></script>
<!-- SlimScroll -->
<script src="../adminlte/bower_components/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"
        th:src="@{/adminlte/bower_components/jquery-slimscroll/jquery.slimscroll.min.js}"></script>
<!-- FastClick -->
<script src="../adminlte/bower_components/fastclick/lib/fastclick.js" type="text/javascript"
        th:src="@{/adminlte/bower_components/fastclick/lib/fastclick.js}"></script>
<!-- AdminLTE for demo purposes -->
<script src="../adminlte/dist/js/demo.js" type="text/javascript"
        th:src="@{/adminlte/dist/js/demo.js}"></script>
<script src="../adminlte/dist/js/jquery.rotate.js" type="text/javascript"
        th:src="@{/adminlte/dist/js/jquery.rotate.js}"></script>
<script type="text/javascript" src="//api.map.baidu.com/api?v=3.0&ak=LBOzhmG9GVhaCYHvbFduFievcCVNBZje"></script>
<script src="../adminlte/plugins/input-mask/jquery.inputmask.js"></script>
<script src="../adminlte/plugins/input-mask/jquery.inputmask.date.extensions.js"></script>
<script src="../adminlte/plugins/input-mask/jquery.inputmask.extensions.js"></script>
<script src="../adminlte/dist/js/demo.js"></script>
<script src="../adminlte/dist/js/jquerysession.js"></script>

<script th:inline="javascript">
    var pagePointer=[[${pagePointer}]]
    console.log(pagePointer)
    var indexOfList=10;
    var filterAni=true;
    var orderArrow=false;
    var orderClick=false;
    var mapListArrow=false;
    var pointArray=new Array()
    var nowPArray=new Array()
    var infoArray=new Array()
    var map = new BMap.Map("allmap",{enableMapClick:false});
    var point = new BMap.Point(104.06,30.67);
    map.centerAndZoom(point,12);
    var top_left_control = new BMap.ScaleControl({anchor: BMAP_ANCHOR_TOP_LEFT});// 左上角，添加比例尺
    var top_left_navigation = new BMap.NavigationControl();  //左上角，添加默认缩放平移控件
    var top_right_navigation = new BMap.NavigationControl({anchor: BMAP_ANCHOR_TOP_RIGHT, type: BMAP_NAVIGATION_CONTROL_SMALL}); //右上角，仅包含平移和缩放按钮
    map.addControl(top_left_control);
    map.addControl(top_left_navigation);
    map.addControl(top_right_navigation);
    map.enableScrollWheelZoom();
    var infoWindow = new BMap.InfoWindow("sadasdasd",opts);


    function myFun(result){
        var cityName = result.name;
        map.setCenter(cityName);
    }
    var myCity = new BMap.LocalCity();
    myCity.get(myFun);

    var opts = {
        width : 250,     // 信息窗口宽度
        height: 80,     // 信息窗口高度
        title : "信息窗口" , // 信息窗口标题
        enableMessage:true//设置允许信息窗发送短息
    };

    $('#tbody').empty()
    for (var i=0;i<[[${resultNum}]];i++){
        $('#tbody').append(
            '<tr ><td><div class="mapListDiv" id="mLD'+(parseInt(i)+1)+'" >\n' +
            '    <span class="badge bg-red">'+(parseInt(i)+1)+'</span><a class="liBtn"  href="/mybook/book?hotelID='+[[${fullResult}]][i]["hotelId"]+'">'+[[${fullResult}]][i]["hotelName"]+'<span class="pull-right badge bg-blue" >'+[[${fullResult}]][i]["hotelRating"]+'</span></a>\n' +
            '        <p style="display: none;"class="mapStar">\n' +
            '            <span class="label label-warning">品质保证</span>\n' +
            '            <span id="mapGrade'+(parseInt(i)+1)+'">\n' +
            '            </span>\n' +
            '        </p>\n' +
            '        <small class="mapStar" style="display: none;"><span >'+[[${fullResult}]][i]["hotelAddress"]+'</span> </small>\n' +
            '    </div>\n' +
            '    </td>\n' +
            '</tr>'
        )
        for (var j=0;j<[[${fullResult}]][i]["hotelGrade"];j++){
            $('#mapGrade'+(parseInt(i)+1)).append('<i class="fa fa-fw fa-star">')
        }
        var content=
        '<div>\n' +
        '    <span class="badge bg-red">'+(parseInt(i)%10+1)+'</span><a href="/mybook/book?hotelID='+[[${fullResult}]][i]["hotelId"]+'">'+[[${fullResult}]][i]["hotelName"]+'<span class="pull-right badge bg-blue" >'+[[${fullResult}]][i]["hotelRating"]+'</span></a>\n' +
        '        <p >\n' +
        '            <span class="label label-warning">品质保证</span>\n' +
        '            <span id="mapGradeT'+(parseInt(i)+1)+'">\n' +
                         [[${fullResult}]][i]["hotelGrade"]+'星级' +
        '            </span>\n' +
        '        </p>\n' +
        '        <small><span >'+[[${fullResult}]][i]["hotelAddress"]+'</span> </small>\n' +
        '    </div>\n'
        var infoWindow = new BMap.InfoWindow(content);
        infoArray.push(infoWindow)
        var lng=parseFloat([[${fullResult}]][i]["lng"])
        var lat=parseFloat([[${fullResult}]][i]["lat"])
        var point=new BMap.Point(lng, lat)
        pointArray[i]=point;
        if (i<10){
            console.log(point)
            addMarker(point,i)
        } else {
            continue
        }

    }
    console.log(infoArray)

    $("td").click(function () {
        if ($(this).children("div.mapListDiv").css("height")=="75px"){
            $(this).children("div.mapListDiv").children(".mapStar").slideUp(100,function () {
                $('td').children("div.mapListDiv").animate({height:'20px'},250)
            });
            map.closeInfoWindow()

        }
        else{
            $('td').children("div.mapListDiv").children(".mapStar").slideUp(100)
            $('td').children("div.mapListDiv").animate({height:'20px'},250)
            $(this).children("div.mapListDiv").animate({height:'75px'},250)
            $(this).children("div.mapListDiv").children(".mapStar").slideDown(100)
            var t=parseInt(($(this).children("div.mapListDiv").attr("id")).substring(3))-1
            var x=parseInt($(this).children("div.mapListDiv").children(".bg-red").text())-1
            map.openInfoWindow(infoArray[t],nowPArray[x]);
            map.panTo(nowPArray[x])
        }
    })
    $('#example2').DataTable({
        'paging'      : true,
        'lengthChange': false,
        'searching'   : false,
        'ordering'    : false,
        'info'        : false,
        'autoWidth'   : false
    })

    $("#example2_paginate").css({"position":"absolute","left":"-150px"})
    $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
    $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
    $(".dataTables_empty").text("无搜索结果")

    $("#example2_paginate").on("click",function (event) {
        $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
        $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
        var index=$(this).children("ul").children(".active").children("a").text()
        console.log(index)
        for (var i=1;i<=10;i++){
            $('#mLD'+((parseInt(index)-1)*10+i)).children("span.bg-red").text(i)
        }
        deletePoint()
        map.closeInfoWindow()
        nowPArray.length=0
        for (var j=0;j<10;j++){
            var x=(parseInt(index)-1)*10+j
            addMarker(pointArray[x],x)
            console.log(pointArray[x])
        }
        console.log(nowPArray)
    })

    $("#mapNavBtn").click(function () {

    })



    $("#topArrow").click(function(){
        $(document).scrollTop(0);
    })

    $('#filterBtn').click(function () {
        if (filterAni==false){
            $('#filterContent').slideUp(250,function () {
                $('#FilterDiv').animate({left:'-200px'},function () {
                    $('#filterBtn').rotate({animateTo: 180,duration:250});

                });
            });
            filterAni=true;
        }
        else{
            $('#FilterDiv').animate({left:'15px'},function (){
                $('#filterContent').slideDown(250,function () {
                    $('#filterBtn').rotate({animateTo: 0,duration:250});
                })
            })
            filterAni=false;
        }


    })

    $('#mapLisrBtn').click(function () {
        if (mapListArrow==false){
            $('#tableWrapper').slideUp(500,function () {
                $('#mapLisrBtn').rotate({animateTo: 180,duration:500});
                $('#mapListNav').slideUp(100)
                $('#mapBox').on("mouseenter",function () {
                    $('#mapListNav').slideDown(100)
                })
                $('#mapBox').on("mouseleave",function () {
                    $('#mapListNav').slideUp(100)
                })
            });
            mapListArrow=true;
        }
        else{
            $('#mapBox').off("mouseleave")
            $('#mapBox').off("mouseenter")
            $('#tableWrapper').slideDown(500,function () {
                $('#mapLisrBtn').rotate({animateTo: 0,duration:500});

            })
            mapListArrow=false;
        }


    })


    $('#listSwitch').click(function(){
        $('#mapBox').slideUp(250)
        $('#allmap').slideUp(250,function () {
            $('#resultSection').slideDown(350,function () {
                if ($('#numOfHotel').text()=="0") {


                }
                else {
                    $('.fullResultBox').slideDown(350,function () {
                        if ($("#numOfHotel").text()>10){
                            $('.downList').slideDown(350);
                        }
                    })
                }

            })
        })

    })
    $('#mapSwitch').click(function(){
        $('.downList').slideUp();

            if($('#numOfHotel').text()=="0"){
                $('#resultSection').slideUp(250,function () {
                    $('#allmap').slideDown(350)
                    $('#mapBox').slideDown(350)
                })
            }
            else{
                $('.fullResultBox').slideUp(250,function () {
                    $('#resultSection').slideUp(250,function () {
                        $('#allmap').slideDown(350)
                        $('#mapBox').slideDown(350)
                    })
                })
            }


    })

    var xmlhttp;
    if (window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject();
    }

    $(function () {

        var resultNumX=[[${resultNum}]]
        if (resultNumX>11) {
            $("#downList").show();
        }
        else{
            $("#downList").hide();
        }

        xmlhttp.open("GET", "/504/city?country=" + encodeURI(encodeURI($("#CountrySelect").val())), true);
        xmlhttp.send();
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var text;
                text = xmlhttp.responseText;
                var jsonData = JSON.parse(text);
                for (x in jsonData) {
                    if (jsonData[x]=="成都") {
                        $("#CitySelect").append('<option selected="selected">' + jsonData[x] + '</option>');
                        $("#CitySelect2").append('<option selected="selected">' + jsonData[x] + '</option>');
                    }
                    else{
                        $("#CitySelect").append('<option>' + jsonData[x] + '</option>');
                        $("#CitySelect2").append('<option>' + jsonData[x] + '</option>');
                        console.log("tesdasdas")
                    }

                }
                $('.select2').select2();
            }
        }
    })
    $("#mapNavBtn").click(function () {
        var text=$('#mapHKey').val()
        var coKey=encodeURI(encodeURI($("#CountrySelect2").val()))
        var ciKey=encodeURI(encodeURI($("#CitySelect2").val()))
        xmlhttp.open("GET", "/504/searchList?hotelKey="+text+"&countryKey="+coKey+"&cityKey="+ciKey, true);
        xmlhttp.send();
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var text;
                text = xmlhttp.responseText;
                text = JSON.parse(text)
                var num = parseInt(text.length)
                $('#numOfHotel').text(num);
                $('.fullResultBox').remove();
                infoArray.length=0
                pointArray.length=0
                nowPArray.length=0
                deletePoint()
                $('#tableWrapper').empty();
                $('#tableWrapper').append('<table id="example2" class="table table-bordered table-hover">\n' +
                    '                            <thead style="display: none">\n' +
                    '                            <tr>\n' +
                    '                                <th></th>\n' +
                    '                            </tr>\n' +
                    '                            </thead>\n' +
                    '                            <tbody id="tbody">\n' +
                    '                            </tbody>\n' +
                    '                        </table>')
                for (var j=0;j<num;j++) {
                    $('#tbody').append(
                        '<tr ><td><div class="mapListDiv" id="mLD'+(parseInt(j)+1)+'" >\n' +
                        '    <span class="badge bg-red">'+(parseInt(j)+1)+'</span><a class="liBtn"  href="/mybook/book?hotelID='+text[j]["hotelId"]+'">'+text[j]["hotelName"]+'<span class="pull-right badge bg-blue" >'+text[j]["hotelRating"]+'</span></a>\n' +
                        '        <p style="display: none;"class="mapStar">\n' +
                        '            <span class="label label-warning">品质保证</span>\n' +
                        '            <span id="mapGrade'+(parseInt(j)+1)+'">\n' +
                        '            </span>\n' +
                        '        </p>\n' +
                        '        <small class="mapStar" style="display: none;"><span >'+text[j]["hotelAddress"]+'</span> </small>\n' +
                        '    </div>\n' +
                        '    </td>\n' +
                        '</tr>'
                    )
                    for (var k=0;k<text[j]["hotelGrade"];k++){
                        $('#mapGrade'+(parseInt(j)+1)).append('<i class="fa fa-fw fa-star">')
                    }
                    var content=
                        '<div>\n' +
                        '    <span class="badge bg-red">'+(parseInt(j)%10+1)+'</span><a href="/mybook/book?hotelID='+text[j]["hotelId"]+'">'+text[j]["hotelName"]+'<span class="pull-right badge bg-blue" >'+text[j]["hotelRating"]+'</span></a>\n' +
                        '        <p >\n' +
                        '            <span class="label label-warning">品质保证</span>\n' +
                        '            <span id="mapGradeT'+(parseInt(j)+1)+'">\n' +
                        text[j]["hotelGrade"]+'星级' +
                        '            </span>\n' +
                        '        </p>\n' +
                        '        <small><span >'+text[j]["hotelAddress"]+'</span> </small>\n' +
                        '    </div>\n'
                    var infoWindow = new BMap.InfoWindow(content);
                    infoArray.push(infoWindow)
                    var lng=parseFloat(text[j]["lng"])
                    var lat=parseFloat(text[j]["lat"])
                    var point=new BMap.Point(lng, lat)
                    pointArray[j]=point;
                    if (j<10){
                        console.log(point)
                        addMarker(point,j)
                    }
                    else {
                        continue
                    }

                }
                $("td").click(function () {
                    if ($(this).children("div.mapListDiv").css("height")=="75px"){
                        $(this).children("div.mapListDiv").children(".mapStar").slideUp(100,function () {
                            $('td').children("div.mapListDiv").animate({height:'20px'},250)
                        });
                        map.closeInfoWindow()

                    }
                    else{
                        $('td').children("div.mapListDiv").children(".mapStar").slideUp(100)
                        $('td').children("div.mapListDiv").animate({height:'20px'},250)
                        $(this).children("div.mapListDiv").animate({height:'75px'},250)
                        $(this).children("div.mapListDiv").children(".mapStar").slideDown(100)
                        var t=parseInt(($(this).children("div.mapListDiv").attr("id")).substring(3))-1
                        var x=parseInt($(this).children("div.mapListDiv").children(".bg-red").text())-1
                        map.openInfoWindow(infoArray[t],nowPArray[x]);
                        map.panTo(nowPArray[x])
                    }
                })
                $('#example2').DataTable({
                    'paging'      : true,
                    'lengthChange': false,
                    'searching'   : false,
                    'ordering'    : false,
                    'info'        : false,
                    'autoWidth'   : false
                })


                $("#example2_paginate").css({"position":"absolute","left":"-150px"})
                $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
                $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
                $(".dataTables_empty").text("无搜索结果")
                $("#example2_paginate").on("click",function (event) {
                    $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
                    $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
                    var index=$(this).children("ul").children(".active").children("a").text()
                    console.log(index)
                    for (var i=1;i<=10;i++){
                        $('#mLD'+((parseInt(index)-1)*10+i)).children("span.bg-red").text(i)
                    }
                    deletePoint()
                    map.closeInfoWindow()
                    nowPArray.length=0
                    for (var j=0;j<10;j++){
                        var x=(parseInt(index)-1)*10+j
                        addMarker(pointArray[x],x)
                        console.log(pointArray[x])
                    }
                    console.log(nowPArray)
                })



                if (parseInt(num) == 0) {
                    $('.downList').hide()
                    $('#none2').show();
                }
                else if (num < 10) {
                    var x = 0;
                    $('#none2').after(
                        '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                        '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                        '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                        '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                        '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                        '        </div>\n' +
                        '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                        '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                        '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                        '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                        '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                        '            </h3>\n' +
                        '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                        '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                        '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                        '                </span>\n' +
                        '            </p>\n' +
                        '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                        '            <span class="product-description block">\n' +
                        '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                        '            </span>\n' +
                        '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                        '        </div>\n' +
                        '    </div>\n' +
                        '</div>'
                    );
                    for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                        $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                    }
                    x = x + 1;
                    for (x; x < num; x++) {
                        console.log(text[x])
                        $('#resultList' + (parseInt(x))).after(
                            '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                            '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                            '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                            '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                            '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                            '        </div>\n' +
                            '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                            '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                            '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                            '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                            '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                            '            </h3>\n' +
                            '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                            '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                            '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                            '                </span>\n' +
                            '            </p>\n' +
                            '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                            '            <span class="product-description block">\n' +
                            '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                            '            </span>\n' +
                            '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                            '        </div>\n' +
                            '    </div>\n' +
                            '</div>'
                        );
                        for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                            $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                        }
                    }
                    $('.downList').hide()
                    $('#none2').hide();
                }
                else {
                    $('#none2').hide();
                    var x = 0;
                    $('#none2').after(
                        '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                        '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                        '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                        '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                        '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                        '        </div>\n' +
                        '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                        '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                        '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                        '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                        '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                        '            </h3>\n' +
                        '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                        '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                        '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                        '                </span>\n' +
                        '            </p>\n' +
                        '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                        '            <span class="product-description block">\n' +
                        '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                        '            </span>\n' +
                        '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                        '        </div>\n' +
                        '    </div>\n' +
                        '</div>'
                    );
                    for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                        $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                    }
                    x = x + 1;
                    for (x; x < 10; x++) {
                        console.log(text[x])
                        $('#resultList' + (parseInt(x))).after(
                            '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                            '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                            '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                            '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                            '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                            '        </div>\n' +
                            '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                            '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                            '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                            '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                            '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                            '            </h3>\n' +
                            '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                            '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                            '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                            '                </span>\n' +
                            '            </p>\n' +
                            '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                            '            <span class="product-description block">\n' +
                            '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                            '            </span>\n' +
                            '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                            '        </div>\n' +
                            '    </div>\n' +
                            '</div>'
                        );
                        for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                            $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                        }
                    }
                    if (num == 10) {
                        $('.downList').hide();
                    } else {
                        $('.downList').show();
                    }

                    //indexOfList=parseInt($('#numOfHotel').text())
                    indexOfList = 10;
                }


            }
        }
    })

    $("#search-btn").click(function () {
        var text=$('#searchText').val()
        var coKey=encodeURI(encodeURI($("#CountrySelect").val()))
        var ciKey=encodeURI(encodeURI($("#CitySelect").val()))
        xmlhttp.open("GET", "/504/searchList?hotelKey="+text+"&countryKey="+coKey+"&cityKey="+ciKey, true);
        xmlhttp.send();
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var text;
                text = xmlhttp.responseText;
                text = JSON.parse(text)
                var num = parseInt(text.length)
                $('#numOfHotel').text(num);
                $('.fullResultBox').remove();
                $("#none1").hide()
                infoArray.length=0
                pointArray.length=0
                nowPArray.length=0
                deletePoint()
                $('#tableWrapper').empty();
                $('#tableWrapper').append('<table id="example2" class="table table-bordered table-hover">\n' +
                    '                            <thead style="display: none">\n' +
                    '                            <tr>\n' +
                    '                                <th></th>\n' +
                    '                            </tr>\n' +
                    '                            </thead>\n' +
                    '                            <tbody id="tbody">\n' +
                    '                            </tbody>\n' +
                    '                        </table>')
                for (var j=0;j<num;j++) {
                    $('#tbody').append(
                        '<tr ><td><div class="mapListDiv" id="mLD'+(parseInt(j)+1)+'" >\n' +
                        '    <span class="badge bg-red">'+(parseInt(j)+1)+'</span><a class="liBtn"  href="/mybook/book?hotelID='+text[j]["hotelId"]+'">'+text[j]["hotelName"]+'<span class="pull-right badge bg-blue" >'+text[j]["hotelRating"]+'</span></a>\n' +
                        '        <p style="display: none;"class="mapStar">\n' +
                        '            <span class="label label-warning">品质保证</span>\n' +
                        '            <span id="mapGrade'+(parseInt(j)+1)+'">\n' +
                        '            </span>\n' +
                        '        </p>\n' +
                        '        <small class="mapStar" style="display: none;"><span >'+text[j]["hotelAddress"]+'</span> </small>\n' +
                        '    </div>\n' +
                        '    </td>\n' +
                        '</tr>'
                    )
                    for (var k=0;k<text[j]["hotelGrade"];k++){
                        $('#mapGrade'+(parseInt(j)+1)).append('<i class="fa fa-fw fa-star">')
                    }
                    var content=
                        '<div>\n' +
                        '    <span class="badge bg-red">'+(parseInt(j)%10+1)+'</span><a href="/mybook/book?hotelID='+text[j]["hotelId"]+'">'+text[j]["hotelName"]+'<span class="pull-right badge bg-blue" >'+text[j]["hotelRating"]+'</span></a>\n' +
                        '        <p >\n' +
                        '            <span class="label label-warning">品质保证</span>\n' +
                        '            <span id="mapGradeT'+(parseInt(j)+1)+'">\n' +
                        text[j]["hotelGrade"]+'星级' +
                        '            </span>\n' +
                        '        </p>\n' +
                        '        <small><span >'+text[j]["hotelAddress"]+'</span> </small>\n' +
                        '    </div>\n'
                    var infoWindow = new BMap.InfoWindow(content);
                    infoArray.push(infoWindow)
                    var lng=parseFloat(text[j]["lng"])
                    var lat=parseFloat(text[j]["lat"])
                    var point=new BMap.Point(lng, lat)
                    pointArray[j]=point;
                    if (j<10){
                        console.log(point)
                        addMarker(point,j)
                    }
                    else {
                        continue
                    }

                }
                $("td").click(function () {
                    if ($(this).children("div.mapListDiv").css("height")=="75px"){
                        $(this).children("div.mapListDiv").children(".mapStar").slideUp(100,function () {
                            $('td').children("div.mapListDiv").animate({height:'20px'},250)
                        });
                        map.closeInfoWindow()

                    }
                    else{
                        $('td').children("div.mapListDiv").children(".mapStar").slideUp(100)
                        $('td').children("div.mapListDiv").animate({height:'20px'},250)
                        $(this).children("div.mapListDiv").animate({height:'75px'},250)
                        $(this).children("div.mapListDiv").children(".mapStar").slideDown(100)
                        var t=parseInt(($(this).children("div.mapListDiv").attr("id")).substring(3))-1
                        var x=parseInt($(this).children("div.mapListDiv").children(".bg-red").text())-1
                        map.openInfoWindow(infoArray[t],nowPArray[x]);
                        map.panTo(nowPArray[x])
                    }
                })
                $('#example2').DataTable({
                    'paging'      : true,
                    'lengthChange': false,
                    'searching'   : false,
                    'ordering'    : false,
                    'info'        : false,
                    'autoWidth'   : false
                })


                $("#example2_paginate").css({"position":"absolute","left":"-150px"})
                $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
                $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
                $(".dataTables_empty").text("无搜索结果")
                $("#example2_paginate").on("click",function (event) {
                    $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
                    $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
                    var index=$(this).children("ul").children(".active").children("a").text()
                    console.log(index)
                    for (var i=1;i<=10;i++){
                        $('#mLD'+((parseInt(index)-1)*10+i)).children("span.bg-red").text(i)
                    }
                    deletePoint()
                    map.closeInfoWindow()
                    nowPArray.length=0
                    for (var j=0;j<10;j++){
                        var x=(parseInt(index)-1)*10+j
                        addMarker(pointArray[x],x)
                        console.log(pointArray[x])
                    }
                    console.log(nowPArray)
                })


                
                if (parseInt(num) == 0) {
                    $('.downList').hide()
                    $('#none2').show();
                }
                else if (num < 10) {
                    var x = 0;
                    $('#none2').after(
                        '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                        '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                        '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                        '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                        '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                        '        </div>\n' +
                        '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                        '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                        '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                        '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                        '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                        '            </h3>\n' +
                        '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                        '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                        '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                        '                </span>\n' +
                        '            </p>\n' +
                        '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                        '            <span class="product-description block">\n' +
                        '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                        '            </span>\n' +
                        '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                        '        </div>\n' +
                        '    </div>\n' +
                        '</div>'
                    );
                    for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                        $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                    }
                    x = x + 1;
                    for (x; x < num; x++) {
                        console.log(text[x])
                        $('#resultList' + (parseInt(x))).after(
                            '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                            '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                            '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                            '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                            '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                            '        </div>\n' +
                            '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                            '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                            '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                            '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                            '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                            '            </h3>\n' +
                            '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                            '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                            '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                            '                </span>\n' +
                            '            </p>\n' +
                            '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                            '            <span class="product-description block">\n' +
                            '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                            '            </span>\n' +
                            '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                            '        </div>\n' +
                            '    </div>\n' +
                            '</div>'
                        );
                        for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                            $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                        }
                    }
                    $('.downList').hide()
                    $('#none2').hide();
                }
                else {
                    $('#none2').hide();
                    var x = 0;
                    $('#none2').after(
                        '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                        '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                        '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                        '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                        '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                        '        </div>\n' +
                        '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                        '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                        '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                        '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                        '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                        '            </h3>\n' +
                        '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                        '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                        '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                        '                </span>\n' +
                        '            </p>\n' +
                        '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                        '            <span class="product-description block">\n' +
                        '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                        '            </span>\n' +
                        '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                        '        </div>\n' +
                        '    </div>\n' +
                        '</div>'
                    );
                    for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                        $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                    }
                    x = x + 1;
                    for (x; x < 10; x++) {
                        console.log(text[x])
                        $('#resultList' + (parseInt(x))).after(
                            '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                            '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                            '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                            '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                            '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                            '        </div>\n' +
                            '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                            '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                            '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                            '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                            '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                            '            </h3>\n' +
                            '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                            '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                            '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                            '                </span>\n' +
                            '            </p>\n' +
                            '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                            '            <span class="product-description block">\n' +
                            '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                            '            </span>\n' +
                            '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                            '        </div>\n' +
                            '    </div>\n' +
                            '</div>'
                        );
                        for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                            $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                        }
                    }
                    if (num == 10) {
                        $('.downList').hide();
                    } else {
                        $('.downList').show();
                    }

                    //indexOfList=parseInt($('#numOfHotel').text())
                    indexOfList = 10;
                }
                $(".whiteToB").css("color","white")
                $(".whiteToB").css("background","#605ca8")
                $("#select2-gradeSelectL-container").text("一星级")
                $("#select2-gradeSelectL-container").attr("title","一星级")
                $('.select2').select2();

            }
        }
    })




    $(".whiteToB").mouseenter(function () {
        $(this).css("color","black")
        $(this).css("background","white")
    })

    $(".whiteToB").mouseleave(function () {
        $(this).css("color","white")
        $(this).css("background","#605ca8")
    })
    $(".whiteToB").click(function () {
        if (orderClick==false){
            $(".whiteToB").css("color","white")
            $(".whiteToB").css("background","#605ca8")
            $(this).css("background","white")
            $(this).css("color","black")
            $(this).unbind("mouseleave")
            orderClick=true;
        }
        else{
            $(".whiteToB").css("color","white")
            $(".whiteToB").css("background","#605ca8")
            $(".whiteToB").bind("mouseleave",function () {
                $(this).css("color","white")
                $(this).css("background","#605ca8")
            })
            $(this).css("background","white")
            $(this).css("color","black")
            $(this).unbind("mouseleave")
        }
        
        if ($(this).text()=="评分"){
            var orderChoose=1;
        }
        else if ($(this).text()=="星级"){
            var orderChoose=2;
        }
        else if ($(this).text()=="价格"){

            if (orderArrow==false) {
                var orderChoose=3.5;
            }
            else{
                var orderChoose=3.0;
            }
        }

        xmlhttp.open("GET", "/504/order?orderChoose="+orderChoose, true);
        xmlhttp.send();
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var text;
                text = xmlhttp.responseText;
                text = JSON.parse(text)
                var num = parseInt(text.length)
                $('#numOfHotel').text(num);
                $('.fullResultBox').remove();
                infoArray.length=0
                pointArray.length=0
                nowPArray.length=0
                deletePoint()
                $("#none1").hide()
                $('#tableWrapper').empty();
                $('#tableWrapper').append('<table id="example2" class="table table-bordered table-hover">\n' +
                    '                            <thead style="display: none">\n' +
                    '                            <tr>\n' +
                    '                                <th></th>\n' +
                    '                            </tr>\n' +
                    '                            </thead>\n' +
                    '                            <tbody id="tbody">\n' +
                    '                            </tbody>\n' +
                    '                        </table>')
                for (var j=0;j<num;j++) {
                    $('#tbody').append(
                        '<tr ><td><div class="mapListDiv" id="mLD'+(parseInt(j)+1)+'" >\n' +
                        '    <span class="badge bg-red">'+(parseInt(j)+1)+'</span><a class="liBtn"  href="/mybook/book?hotelID='+text[j]["hotelId"]+'">'+text[j]["hotelName"]+'<span class="pull-right badge bg-blue" >'+text[j]["hotelRating"]+'</span></a>\n' +
                        '        <p style="display: none;"class="mapStar">\n' +
                        '            <span class="label label-warning">品质保证</span>\n' +
                        '            <span id="mapGrade'+(parseInt(j)+1)+'">\n' +
                        '            </span>\n' +
                        '        </p>\n' +
                        '        <small class="mapStar" style="display: none;"><span >'+text[j]["hotelAddress"]+'</span> </small>\n' +
                        '    </div>\n' +
                        '    </td>\n' +
                        '</tr>'
                    )
                    for (var k=0;k<text[j]["hotelGrade"];k++){
                        $('#mapGrade'+(parseInt(j)+1)).append('<i class="fa fa-fw fa-star">')
                    }
                    var content=
                        '<div>\n' +
                        '    <span class="badge bg-red">'+(parseInt(j)%10+1)+'</span><a href="/mybook/book?hotelID='+text[j]["hotelId"]+'">'+text[j]["hotelName"]+'<span class="pull-right badge bg-blue" >'+text[j]["hotelRating"]+'</span></a>\n' +
                        '        <p >\n' +
                        '            <span class="label label-warning">品质保证</span>\n' +
                        '            <span id="mapGradeT'+(parseInt(j)+1)+'">\n' +
                        text[j]["hotelGrade"]+'星级' +
                        '            </span>\n' +
                        '        </p>\n' +
                        '        <small><span >'+text[j]["hotelAddress"]+'</span> </small>\n' +
                        '    </div>\n'
                    var infoWindow = new BMap.InfoWindow(content);
                    infoArray.push(infoWindow)
                    var lng=parseFloat(text[j]["lng"])
                    var lat=parseFloat(text[j]["lat"])
                    var point=new BMap.Point(lng, lat)
                    pointArray[j]=point;
                    if (j<10){
                        console.log(point)
                        addMarker(point,j)
                    }
                    else {
                        continue
                    }

                }
                $("td").click(function () {
                    if ($(this).children("div.mapListDiv").css("height")=="75px"){
                        $(this).children("div.mapListDiv").children(".mapStar").slideUp(100,function () {
                            $('td').children("div.mapListDiv").animate({height:'20px'},250)
                        });
                        map.closeInfoWindow()

                    }
                    else{
                        $('td').children("div.mapListDiv").children(".mapStar").slideUp(100)
                        $('td').children("div.mapListDiv").animate({height:'20px'},250)
                        $(this).children("div.mapListDiv").animate({height:'75px'},250)
                        $(this).children("div.mapListDiv").children(".mapStar").slideDown(100)
                        var t=parseInt(($(this).children("div.mapListDiv").attr("id")).substring(3))-1
                        var x=parseInt($(this).children("div.mapListDiv").children(".bg-red").text())-1
                        map.openInfoWindow(infoArray[t],nowPArray[x]);
                        map.panTo(nowPArray[x])
                    }
                })
                $('#example2').DataTable({
                    'paging'      : true,
                    'lengthChange': false,
                    'searching'   : false,
                    'ordering'    : false,
                    'info'        : false,
                    'autoWidth'   : false
                })


                $("#example2_paginate").css({"position":"absolute","left":"-150px"})
                $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
                $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
                $(".dataTables_empty").text("无搜索结果")
                $("#example2_paginate").on("click",function (event) {
                    $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
                    $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
                    var index=$(this).children("ul").children(".active").children("a").text()
                    console.log(index)
                    for (var i=1;i<=10;i++){
                        $('#mLD'+((parseInt(index)-1)*10+i)).children("span.bg-red").text(i)
                    }
                    deletePoint()
                    map.closeInfoWindow()
                    nowPArray.length=0
                    for (var j=0;j<10;j++){
                        var x=(parseInt(index)-1)*10+j
                        addMarker(pointArray[x],x)
                        console.log(pointArray[x])
                    }
                    console.log(nowPArray)
                })



                if (parseInt(num) == 0) {
                    $('.downList').hide()
                    $('#none2').show();
                }
                else if (num < 10) {
                    var x = 0;
                    $('#none2').after(
                        '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                        '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                        '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                        '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                        '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                        '        </div>\n' +
                        '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                        '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                        '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                        '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                        '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                        '            </h3>\n' +
                        '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                        '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                        '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                        '                </span>\n' +
                        '            </p>\n' +
                        '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                        '            <span class="product-description block">\n' +
                        '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                        '            </span>\n' +
                        '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                        '        </div>\n' +
                        '    </div>\n' +
                        '</div>'
                    );
                    for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                        $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                    }
                    x = x + 1;
                    for (x; x < num; x++) {
                        console.log(text[x])
                        $('#resultList' + (parseInt(x))).after(
                            '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                            '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                            '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                            '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                            '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                            '        </div>\n' +
                            '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                            '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                            '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                            '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                            '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                            '            </h3>\n' +
                            '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                            '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                            '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                            '                </span>\n' +
                            '            </p>\n' +
                            '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                            '            <span class="product-description block">\n' +
                            '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                            '            </span>\n' +
                            '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                            '        </div>\n' +
                            '    </div>\n' +
                            '</div>'
                        );
                        for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                            $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                        }
                    }
                    $('.downList').hide()
                    $('#none2').hide();
                }
                else {
                    $('#none2').hide();
                    var x = 0;
                    $('#none2').after(
                        '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                        '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                        '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                        '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                        '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                        '        </div>\n' +
                        '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                        '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                        '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                        '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                        '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                        '            </h3>\n' +
                        '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                        '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                        '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                        '                </span>\n' +
                        '            </p>\n' +
                        '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                        '            <span class="product-description block">\n' +
                        '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                        '            </span>\n' +
                        '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                        '        </div>\n' +
                        '    </div>\n' +
                        '</div>'
                    );
                    for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                        $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                    }
                    x = x + 1;
                    for (x; x < 10; x++) {
                        console.log(text[x])
                        $('#resultList' + (parseInt(x))).after(
                            '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                            '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                            '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                            '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                            '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                            '        </div>\n' +
                            '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                            '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                            '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                            '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                            '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                            '            </h3>\n' +
                            '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                            '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                            '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                            '                </span>\n' +
                            '            </p>\n' +
                            '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                            '            <span class="product-description block">\n' +
                            '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                            '            </span>\n' +
                            '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                            '        </div>\n' +
                            '    </div>\n' +
                            '</div>'
                        );
                        for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                            $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                        }
                    }
                    if (num == 10) {
                        $('.downList').hide();
                    } else {
                        $('.downList').show();
                    }

                    //indexOfList=parseInt($('#numOfHotel').text())
                    indexOfList = 10;
                }

            }
        }


        
    })

    $('#orderArrow').click(function () {
        if (orderArrow==false){
            $(this).rotate(180)
            orderArrow=true
        }
        else{
            $(this).rotate(360);
            orderArrow=false
        }
    })


    $(".whiteToB").dblclick(function () {
        if (orderClick==true){
            $(".whiteToB").css("color","white")
            $(".whiteToB").css("background","#605ca8")
            $(".whiteToB").bind("mouseleave",function () {
                $(this).css("color","white")
                $(this).css("background","#605ca8")
            })
            orderClick=false;
        }
    })


    $("#CountrySelect").change(function () {
        xmlhttp.open("GET", "/504/city?country=" + encodeURI(encodeURI($("#CountrySelect").val())), true);
        xmlhttp.send();
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var text;
                text = xmlhttp.responseText;
                var jsonData = JSON.parse(text);
                $("#CitySelect").empty();
                for (x in jsonData) {
                    $("#CitySelect").append('<option>' + jsonData[x] + '</option>');
                }
                $('.select2').select2();
            }
        }   
    });
    $("#CountrySelect2").change(function () {
        xmlhttp.open("GET", "/504/city?country=" + encodeURI(encodeURI($("#CountrySelect2").val())), true);
        xmlhttp.send();
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var text;
                text = xmlhttp.responseText;
                var jsonData = JSON.parse(text);
                $("#CitySelect2").empty();
                for (x in jsonData) {
                    $("#CitySelect2").append('<option>' + jsonData[x] + '</option>');
                }
                $('.select2').select2();
            }
        }
    });

    $('#filterSub').click(function () {

            var lowPrice = $('#lowText').val();
            var highPrice = $('#highText').val();
            for (var i = 1; i <= 5; i++) {
                if ($("#gradeSelectL option:selected").attr("id") == "gsl" + i) {
                    var lowGrade = i;
                }
            }
            for (var i = 1; i <= 5; i++) {
                if ($("#gradeSelectH option:selected").attr("id") == "gsh" + i) {
                    var highGrade = i;
                }
            }
            for (var i = 1; i <= 9; i++) {
                if ($('#ratingSelect option:selected').attr("id") == "rs" + i) {
                    var rating = i;
                    break;
                } else {
                    rating = 0;
                }
            }

            if (lowPrice != "" && !isNumber(lowPrice)) {
                alert("最低价需要输入有效数字");
            } else if (highPrice != "" && !isNumber(highPrice)) {
                alert("最高价需要输入有效数字");
            } else if (lowGrade > highGrade) {
                alert("请将星级从小到大设置");
            } else {
                xmlhttp.open("GET", "/504/filter?lowPrice=" + lowPrice + "&highPrice=" + highPrice + "&lowGrade=" + lowGrade + "&highGrade=" + highGrade + "&rating=" + rating, true);
                xmlhttp.send();
                xmlhttp.onreadystatechange = function () {
                    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                        var text;
                        text = xmlhttp.responseText;
                        text = JSON.parse(text)
                        var num = parseInt(text.length)
                        $('#numOfHotel').text(num);
                        $('.fullResultBox').remove();
                        infoArray.length=0
                        pointArray.length=0
                        nowPArray.length=0
                        deletePoint()
                        $("#none1").hide()
                        $('#tableWrapper').empty();
                        $('#tableWrapper').append('<table id="example2" class="table table-bordered table-hover">\n' +
                            '                            <thead style="display: none">\n' +
                            '                            <tr>\n' +
                            '                                <th></th>\n' +
                            '                            </tr>\n' +
                            '                            </thead>\n' +
                            '                            <tbody id="tbody">\n' +
                            '                            </tbody>\n' +
                            '                        </table>')
                        for (var j=0;j<num;j++) {
                            $('#tbody').append(
                                '<tr ><td><div class="mapListDiv" id="mLD'+(parseInt(j)+1)+'" >\n' +
                                '    <span class="badge bg-red">'+(parseInt(j)+1)+'</span><a class="liBtn"  href="/mybook/book?hotelID='+text[j]["hotelId"]+'">'+text[j]["hotelName"]+'<span class="pull-right badge bg-blue" >'+text[j]["hotelRating"]+'</span></a>\n' +
                                '        <p style="display: none;"class="mapStar">\n' +
                                '            <span class="label label-warning">品质保证</span>\n' +
                                '            <span id="mapGrade'+(parseInt(j)+1)+'">\n' +
                                '            </span>\n' +
                                '        </p>\n' +
                                '        <small class="mapStar" style="display: none;"><span >'+text[j]["hotelAddress"]+'</span> </small>\n' +
                                '    </div>\n' +
                                '    </td>\n' +
                                '</tr>'
                            )
                            for (var k=0;k<text[j]["hotelGrade"];k++){
                                $('#mapGrade'+(parseInt(j)+1)).append('<i class="fa fa-fw fa-star">')
                            }
                            var content=
                                '<div>\n' +
                                '    <span class="badge bg-red">'+(parseInt(j)%10+1)+'</span><a href="/mybook/book?hotelID='+text[j]["hotelId"]+'">'+text[j]["hotelName"]+'<span class="pull-right badge bg-blue" >'+text[j]["hotelRating"]+'</span></a>\n' +
                                '        <p >\n' +
                                '            <span class="label label-warning">品质保证</span>\n' +
                                '            <span id="mapGradeT'+(parseInt(j)+1)+'">\n' +
                                text[j]["hotelGrade"]+'星级' +
                                '            </span>\n' +
                                '        </p>\n' +
                                '        <small><span >'+text[j]["hotelAddress"]+'</span> </small>\n' +
                                '    </div>\n'
                            var infoWindow = new BMap.InfoWindow(content);
                            infoArray.push(infoWindow)
                            var lng=parseFloat(text[j]["lng"])
                            var lat=parseFloat(text[j]["lat"])
                            var point=new BMap.Point(lng, lat)
                            pointArray[j]=point;
                            if (j<10){
                                console.log(point)
                                addMarker(point,j)
                            }
                            else {
                                continue
                            }

                        }
                        $("td").click(function () {
                            if ($(this).children("div.mapListDiv").css("height")=="75px"){
                                $(this).children("div.mapListDiv").children(".mapStar").slideUp(100,function () {
                                    $('td').children("div.mapListDiv").animate({height:'20px'},250)
                                });
                                map.closeInfoWindow()

                            }
                            else{
                                $('td').children("div.mapListDiv").children(".mapStar").slideUp(100)
                                $('td').children("div.mapListDiv").animate({height:'20px'},250)
                                $(this).children("div.mapListDiv").animate({height:'75px'},250)
                                $(this).children("div.mapListDiv").children(".mapStar").slideDown(100)
                                var t=parseInt(($(this).children("div.mapListDiv").attr("id")).substring(3))-1
                                var x=parseInt($(this).children("div.mapListDiv").children(".bg-red").text())-1
                                map.openInfoWindow(infoArray[t],nowPArray[x]);
                                map.panTo(nowPArray[x])
                            }
                        })
                        $('#example2').DataTable({
                            'paging'      : true,
                            'lengthChange': false,
                            'searching'   : false,
                            'ordering'    : false,
                            'info'        : false,
                            'autoWidth'   : false
                        })


                        $("#example2_paginate").css({"position":"absolute","left":"-150px"})
                        $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
                        $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
                        $(".dataTables_empty").text("无搜索结果")
                        $("#example2_paginate").on("click",function (event) {
                            $("#example2_paginate").children("ul").children(".previous").children("a").text("上一页")
                            $("#example2_paginate").children("ul").children(".next").children("a").text("下一页")
                            var index=$(this).children("ul").children(".active").children("a").text()
                            console.log(index)
                            for (var i=1;i<=10;i++){
                                $('#mLD'+((parseInt(index)-1)*10+i)).children("span.bg-red").text(i)
                            }
                            deletePoint()
                            map.closeInfoWindow()
                            nowPArray.length=0
                            for (var j=0;j<10;j++){
                                var x=(parseInt(index)-1)*10+j
                                addMarker(pointArray[x],x)
                                console.log(pointArray[x])
                            }
                            console.log(nowPArray)
                        })



                        if (parseInt(num) == 0) {
                            $('.downList').hide()
                            $('#none2').show();
                        }
                        else if (num < 10) {
                            var x = 0;
                            $('#none2').after(
                                '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                                '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                                '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                                '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                                '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                                '        </div>\n' +
                                '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                                '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                                '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                                '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                                '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                                '            </h3>\n' +
                                '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                                '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                                '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                                '                </span>\n' +
                                '            </p>\n' +
                                '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                                '            <span class="product-description block">\n' +
                                '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                                '            </span>\n' +
                                '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                                '        </div>\n' +
                                '    </div>\n' +
                                '</div>'
                            );
                            for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                                $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                            }
                            x = x + 1;
                            for (x; x < num; x++) {
                                console.log(text[x])
                                $('#resultList' + (parseInt(x))).after(
                                    '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                                    '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                                    '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                                    '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                                    '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                                    '        </div>\n' +
                                    '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                                    '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                                    '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                                    '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                                    '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                                    '            </h3>\n' +
                                    '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                                    '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                                    '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                                    '                </span>\n' +
                                    '            </p>\n' +
                                    '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                                    '            <span class="product-description block">\n' +
                                    '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                                    '            </span>\n' +
                                    '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                                    '        </div>\n' +
                                    '    </div>\n' +
                                    '</div>'
                                );
                                for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                                    $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                                }
                            }
                            $('.downList').hide()
                            $('#none2').hide();
                        }
                        else {
                            $('#none2').hide();
                            var x = 0;
                            $('#none2').after(
                                '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                                '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                                '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                                '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                                '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                                '        </div>\n' +
                                '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                                '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                                '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                                '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                                '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                                '            </h3>\n' +
                                '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                                '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                                '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                                '                </span>\n' +
                                '            </p>\n' +
                                '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                                '            <span class="product-description block">\n' +
                                '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                                '            </span>\n' +
                                '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                                '        </div>\n' +
                                '    </div>\n' +
                                '</div>'
                            );
                            for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                                $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                            }
                            x = x + 1;
                            for (x; x < 10; x++) {
                                console.log(text[x])
                                $('#resultList' + (parseInt(x))).after(
                                    '<div id="resultList' + (parseInt(x) + 1) + '" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                                    '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                                    '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                                    '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                                    '            <img src="' + text[x]["hotelPhoto1"] + '" alt="Product Image">\n' +
                                    '        </div>\n' +
                                    '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                                    '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                                    '                <a href="javascript:void(0)" class="product-title"><span>' + text[x]["hotelName"] + '</span> </a>\n' +
                                    '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px;width:90px" href="#">\n' +
                                    '                <i class="fa fa-thumbs-up"></i><span>' + text[x]["hotelRating"] + '</span></a></span>\n' +
                                    '            </h3>\n' +
                                    '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">' + text[x]["leastPrice"] + '</span>起</span></h3>\n' +
                                    '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                                    '                <span id="hotelGradeStar' + (parseInt(x) + 1) + '">\n' +
                                    '                </span>\n' +
                                    '            </p>\n' +
                                    '            <small><span>' + text[x]["hotelAddress"] + '</span> </small>\n' +
                                    '            <span class="product-description block">\n' +
                                    '                <p><br>&emsp;&emsp;<span>' + text[x]["hotelOverview"] + '</span></p>\n' +
                                    '            </span>\n' +
                                    '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                                    '        </div>\n' +
                                    '    </div>\n' +
                                    '</div>'
                                );
                                for (var i = 0; i < parseInt(text[x]["hotelGrade"]); i++) {
                                    $('#hotelGradeStar' + (parseInt(x) + 1)).append('<i class="fa fa-fw fa-star" ></i>')
                                }
                            }
                            if (num == 10) {
                                $('.downList').hide();
                            } else {
                                $('.downList').show();
                            }

                            //indexOfList=parseInt($('#numOfHotel').text())
                            indexOfList = 10;
                        }
                        $(".whiteToB").css("color","white")
                        $(".whiteToB").css("background","#605ca8")
                        $("#select2-gradeSelectL-container").text("一星级")
                        $("#select2-gradeSelectL-container").attr("title","一星级")
                        $('.select2').select2();

                    }
                }

            }

    })

    $('.downList').on("click",function (){
        if(indexOfList==parseInt($('#numOfHotel').text())){
            $('#downList').attr("title","已全部加载")
        }
        else {
            var x = 0;
            xmlhttp.open("GET", "/504/down?indexOfList=" + indexOfList, true);
            xmlhttp.send();
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    var text;
                    text = xmlhttp.responseText;
                    text = JSON.parse(text)
                    for (x in text) {
                        console.log(text[x]["hotelName"])
                        $('#resultList'+(parseInt(x)+indexOfList)).after(
                            '<div id="resultList'+(parseInt(x)+indexOfList+1)+'" class="box box-default fullResultBox" style="margin: 5px auto;">\n' +
                            '    <span id="hotelID'+(parseInt(x) + 1)+ '"style="visibility: hidden"; >'+text[x]["hotelId"]+'</span>' +
                            '    <div class="box-body" style="padding-left: 10px;position: relative;">\n' +
                            '        <div class="product-img sidebar-menu" style="float: left;margin-right: 20px;margin-top: 30px">\n' +
                            '            <img src="'+text[x]["hotelPhoto1"]+'" alt="Product Image">\n' +
                            '        </div>\n' +
                            '        <div class="product-info" style="margin-right: 10px;overflow: hidden">\n' +
                            '            <h3><i class="fa fa-fw fa-bed"></i>\n' +
                            '                <a href="javascript:void(0)" class="product-title"><span>'+text[x]["hotelName"]+'</span> </a>\n' +
                            '                <span class="pull-right"><a class="btn btn-warning" style="height: 40px;padding-top: 0px;font-size:25px" href="#">\n'+
                            '                <i class="fa fa-thumbs-up"></i><span>'+text[x]["hotelRating"]+'</span></a></span>\n' +
                            '            </h3>\n'+
                            '            <h3><span class="pull-right text-red"><i class="fa fa-fw fa-cny"></i><span class="hotelFee">'+text[x]["leastPrice"]+'</span>起</span></h3>\n'+
                            '            <p id="hotelStar"><span  class="label label-warning">品质保证</span>\n' +
                            '                <span id="hotelGradeStar'+(parseInt(x)+indexOfList+1)+'">\n'+
                            '                </span>\n' +
                            '            </p>\n' +
                            '            <small><span>'+ text[x]["hotelAddress"]+'</span> </small>\n' +
                            '            <span class="product-description block">\n' +
                            '                <p><br>&emsp;&emsp;<span>'+text[x]["hotelOverview"]+'</span></p>\n' +
                            '            </span>\n' +
                            '            <a class="btn bg-purple btn-lg pull-right infBtn" href="/mybook/book?hotelID='+text[x]["hotelId"]+'" id="resultBtn'+(parseInt(x) + 1)+'">查看详情</a>\n' +
                            '        </div>\n' +
                            '    </div>\n' +
                            '</div>'
                        );
                        for (var i=0;i<parseInt(text[x]["hotelGrade"]);i++){
                            $('#hotelGradeStar'+(parseInt(x)+indexOfList+1)).append('<i class="fa fa-fw fa-star" ></i>')
                        }
                    }
                    x = parseInt(x);
                    if (x + indexOfList + 1 == $('#numOfHotel').text()) {
                        indexOfList = parseInt($('#numOfHotel').text())
                    } else {
                        indexOfList = indexOfList + x + 1;
                    }

                    if(indexOfList==parseInt($('#numOfHotel').text())){
                        $('#downList').hide()
                    }
                }
            }
        }
    })

    function isNumber(value) {         //验证是否为数字
        var patrn = /^(-)?\d+(\.\d+)?$/;
        if (patrn.exec(value) == null || value == "") {
            return false
        } else {
            return true
        }
    }
    function deletePoint(){
        var allOverlay = map.getOverlays();
        for (var i = 0; i < allOverlay.length ; i++){
            map.removeOverlay(allOverlay[i]);
        }
    }

    function addMarker(point,x) {
        console.log(point)
        translateCallback = function (data){
            if(data.status === 0) {
                nowPArray.push(data.points[0])
                var infoWindow = new BMap.InfoWindow("sadasdasd",opts);
                var marker = new BMap.Marker(data.points[0]);
                map.addOverlay(marker);
                marker.addEventListener("click", function(){
                    map.openInfoWindow(infoArray[x],data.points[0]); //开启信息窗口
                    if ($("#mLD"+(parseInt(x)+1)).css("height")=="75px"){
                        $("#mLD"+(parseInt(x)+1)).children(".mapStar").slideUp(100,function () {
                            $('td').children("div.mapListDiv").animate({height:'20px'},250)
                        });
                    }
                    else{
                        $('td').children("div.mapListDiv").children(".mapStar").slideUp(100)
                        $('td').children("div.mapListDiv").animate({height:'20px'},250)
                        $("#mLD"+(parseInt(x)+1)).animate({height:'75px'},250)
                        $("#mLD"+(parseInt(x)+1)).children(".mapStar").slideDown(100)
                    }
                });

            }
        }
        var convertor = new BMap.Convertor();
        var pointArr = [];
        pointArr.push(point);
        convertor.translate(pointArr, 1, 5, translateCallback)
    }
    function myFunction() {
        console.log(pagePointer);
    }
    function myFunction1() {
        // xmlhttp.open("GET", "/504/pageInit",true);
        // xmlhttp.send();
        // xmlhttp.onreadystatechange = function () {
        //     if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
        //         var text;
        //         text = xmlhttp.responseText;
        //         text = JSON.parse(text)
        //         console.log(text["pagePointer"])
        //     }
        // }
        pagePointer=1
    }

</script>



</body>
</html>